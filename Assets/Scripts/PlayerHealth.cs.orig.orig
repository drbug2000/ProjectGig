using System.Collections;
using UnityEngine;

public class PlayerHealth : LivingEntity
{
<<<<<<< HEAD
    //ÇÃ·¹ÀÌ¾îÀÇ hp¸¦ °ü¸®ÇÏ´Â ½ºÅ©¸³Æ®
    //1. È°¼ºÈ­ ½Ã hp °ª ÃÊ±âÈ­
    //2. ÇÇ°İ ½Ã µ¥¹ÌÁö¸¦ ÀÔ°í, »öÀÌ º¯È¯µÈ´Ù.
    //3. ÇÇ°İ ½Ã Hp°¡ 0 ÀÌÇÏÀÏ °æ¿ì »ç¸Á »óÅÂ·Î º¯È¯ÇÑ´Ù.
    //4. »ç¸Á ½Ã: ...¿¡¼­ onDeath ÀÌº¥Æ®¸¦ ±¸µ¶ (°ÔÀÓ ¸Å´ÏÀú¿¡¼­?)
    //5. onDeath: ºñÈ°¼ºÈ­, ÀÎº¥Åä¸® ºñ·ÔÇÑ Á¤º¸ ÃÊ±âÈ­ ÈÄ ÀçÈ°¼ºÈ­
    //6. ¹Ù´Ù¿Í À°Áö¸¦ ÆÇº°ÇÏ¿©, hp°¡ È¸º¹ ¶Ç´Â °¨¼ÒÇÑ´Ù.
    //7. »óÁ¡¿¡¼­ ÇÃ·¹ÀÌ¾îÀÇ hp¸¦ ¾÷±×·¹ÀÌµåÇÒ ¼ö ÀÖ´Ù. :
    //PlayerHealth ÄÄÆ÷³ÍÆ®¸¦ °¡Á®¿Í RestoreHealth()¸¦ ½ÇÇàÇÑ´Ù.
    //8. onDeath ¸Ş¼­µå¸¦ ±¸Çö
    //9. Update ¸Ş¼­µå¿¡¼­ Áö¼Óµ¥¹ÌÁö¿Í Áö¼ÓÈ¸º¹
=======
    //í”Œë ˆì´ì–´ì˜ hpë¥¼ ê´€ë¦¬í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
    //1. í™œì„±í™” ì‹œ hp ê°’ ì´ˆê¸°í™”
    //2. í”¼ê²© ì‹œ ë°ë¯¸ì§€ë¥¼ ì…ê³ , ìƒ‰ì´ ë³€í™˜ëœë‹¤.
    //3. í”¼ê²© ì‹œ Hpê°€ 0 ì´í•˜ì¼ ê²½ìš° ì‚¬ë§ ìƒíƒœë¡œ ë³€í™˜í•œë‹¤.
    //4. ì‚¬ë§ ì‹œ: ...ì—ì„œ onDeath ì´ë²¤íŠ¸ë¥¼ êµ¬ë…
    //5. onDeath: ë¹„í™œì„±í™”, ì¸ë²¤í† ë¦¬ ë¹„ë¡¯í•œ ì •ë³´ ì´ˆê¸°í™” í›„ ì¬í™œì„±í™”
    //6. ë°”ë‹¤ì™€ ìœ¡ì§€ë¥¼ íŒë³„í•˜ì—¬, hpê°€ íšŒë³µ ë˜ëŠ” ê°ì†Œí•œë‹¤.
    //7. ìƒì ì—ì„œ í”Œë ˆì´ì–´ì˜ hpë¥¼ ì—…ê·¸ë ˆì´ë“œí•  ìˆ˜ ìˆë‹¤.
>>>>>>> develop


    private float durationTime = 3; //Áö¼Óµ¥¹ÌÁö ÄğÅ¸ÀÓ


    public SpriteRenderer playerSpriteRenderer;
    public PlayerMove playerMove;
    

    private void Awake()
    {
<<<<<<< HEAD
        //ÄÄÆ÷³ÍÆ® ÇÒ´ç: ÇÇ°İ ½Ã¿¡ »ö º¯È¯À» À§ÇÔ
        playerSpriteRenderer = GetComponent<SpriteRenderer>();
        //ÄÄÆ÷³ÍÆ® ÇÒ´ç: ¹Ù´Ù¿Í À°Áö ÆÇº° À§ÇÔ
=======
        //ì»´í¬ë„ŒíŠ¸ í• ë‹¹: í”¼ê²© ì‹œì— ìƒ‰ ë³€í™˜ì„ ìœ„í•¨
        flshSpriteRenderer = GetComponent<SpriteRenderer>();
        //ì»´í¬ë„ŒíŠ¸ í• ë‹¹: ë°”ë‹¤ì™€ ìœ¡ì§€ íŒë³„ ìœ„í•¨
>>>>>>> develop
        playerMove = GetComponent<PlayerMove>();
    }

    protected override void OnEnable()
    {
        maxHp = 100;
        startingHealth = 100;
        // LivingEntityì˜ OnEnable() ì‹¤í–‰ (ìƒíƒœ ì´ˆê¸°í™”)
        base.OnEnable();
        //¹Ù´Ù, À°ÁöÀÓÀ» ÆÇº°ÇÏ¿© ÇÇ¸¦ ±ğ°Å³ª Ã¤¿î´Ù
        //StartCoroutine(OceanDamaging(seaDamage, new Vector3(0, 0, 0), new Vector3(0, 0, 0)));
    }

    private void Update()
    {
<<<<<<< HEAD
        durationTime -= Time.deltaTime;
=======
        //ë°”ë‹¤, ìœ¡ì§€ í™•ì¸í•˜ì—¬ í”¼ë¥¼ ê¹ëŠ”ë‹¤
        if (playerMove.onboard != true)
        {
            OnDamage(seaDamage,null, new Vector3(0, 0, 0), new Vector3(0, 0, 0));
        }
        else
        {
>>>>>>> develop

        if (!playerMove.onboard && durationTime <= 0 && !dead)
        {
            OnDamage(3, null,Vector3.zero, Vector3.zero );
            durationTime = 3;
        }

        if (playerMove.onboard && durationTime <= 0 && !dead && health < maxHp)
        {
            RestoreHealth(10);
            durationTime = 3;
        }

    }
<<<<<<< HEAD
    

    //»ö º¯È¯ ÄÚ·çÆ¾
    private IEnumerator DamagedEffect()
=======
    //ì²œì²œíˆ íšŒë³µí•˜ëŠ” ì½”ë£¨í‹´ ì²˜ë¦¬
    private IEnumerator Restoring(int value)
>>>>>>> develop
    {
        playerSpriteRenderer.material.color = new Color(1f, 168 / 255f, 168 / 255f);
        yield return new WaitForSeconds(0.3f);
        playerSpriteRenderer.material.color = new Color(1f, 1f, 1f);

    }


    //íšŒë³µ ì²˜ë¦¬
    public override void RestoreHealth(float newHealth)
    {
        // LivingEntityì˜ RestoreHealth() ì‹¤í–‰ (ì²´ë ¥ ì¦ê°€)
        base.RestoreHealth(newHealth);
    }

    // ë°ë¯¸ì§€ ì²˜ë¦¬
    public override void OnDamage(float damage, GameObject hiter, Vector3 hitPoint, Vector3 hitDirection)
    {
<<<<<<< HEAD
        StartCoroutine(DamagedEffect());
        // LivingEntityÀÇ OnDamage() ½ÇÇà(µ¥¹ÌÁö Àû¿ë)

        base.OnDamage(damage, hiter ,hitPoint, hitDirection);
    }
=======
        if (!dead)
        {
            //ë¶‰ì€ ìƒ‰ìœ¼ë¡œ 1ì´ˆê°„ ë³€í™˜í•˜ëŠ” ì½”ë£¨í‹´ ì‹¤í–‰
            StartCoroutine(DamageEffect());
        }

        // LivingEntityì˜ OnDamage() ì‹¤í–‰(ë°ë¯¸ì§€ ì ìš©)
        base.OnDamage(damage, hiter ,hitPoint, hitDirection);
    }
    //ìƒ‰ ë³€í™˜ ì½”ë£¨í‹´ êµ¬í˜„
    private IEnumerator DamageEffect()
    {
        flshSpriteRenderer.material.color = new Color(1f, 168 / 255f, 168 / 255f);
        yield return new WaitForSeconds(2f);
        flshSpriteRenderer.material.color = new Color(1f, 1f, 1f);
    }
>>>>>>> develop
    

    public override void Die()
    {
<<<<<<< HEAD
        //¾Ö´Ï¸ŞÀÌ¼Ç, »ç¿îµå Àç»ı
        
        //GameManagerÀÇ playeronDeath ¸Ş¼­µå ½ÇÇà
        //µ· »©°¡°Å³ª À¯Áö½ÃÅ°±â
        //you died! È­¸éÃ¢¿¡ ¶ç¿ì±â
        // LivingEntityÀÇ Die() ½ÇÇà
=======
        // LivingEntityì˜ Die() ì‹¤í–‰
>>>>>>> develop
        base.Die();

    }
}

//onDeath()




