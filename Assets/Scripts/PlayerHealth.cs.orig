using System.Collections;
using UnityEngine;

public class PlayerHealth : LivingEntity
{
    //ï¿½Ã·ï¿½ï¿½Ì¾ï¿½ï¿½ï¿½ hpï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½Ï´ï¿½ ï¿½ï¿½Å©ï¿½ï¿½Æ®
    //1. È°ï¿½ï¿½È­ ï¿½ï¿½ hp ï¿½ï¿½ ï¿½Ê±ï¿½È­
    //2. ï¿½Ç°ï¿½ ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½Ô°ï¿½, ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½È¯ï¿½È´ï¿½.
    //3. ï¿½Ç°ï¿½ ï¿½ï¿½ Hpï¿½ï¿½ 0 ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½Â·ï¿½ ï¿½ï¿½È¯ï¿½Ñ´ï¿½.
    //4. ï¿½ï¿½ï¿½ ï¿½ï¿½: ...ï¿½ï¿½ï¿½ï¿½ onDeath ï¿½Ìºï¿½Æ®ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½
    //5. onDeath: ï¿½ï¿½È°ï¿½ï¿½È­, ï¿½Îºï¿½ï¿½ä¸® ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ ï¿½Ê±ï¿½È­ ï¿½ï¿½ ï¿½ï¿½È°ï¿½ï¿½È­
    //6. ï¿½Ù´Ù¿ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½Çºï¿½ï¿½Ï¿ï¿½, hpï¿½ï¿½ È¸ï¿½ï¿½ ï¿½Ç´ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½Ñ´ï¿½.
    //7. ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½Ã·ï¿½ï¿½Ì¾ï¿½ï¿½ï¿½ hpï¿½ï¿½ ï¿½ï¿½ï¿½×·ï¿½ï¿½Ìµï¿½ï¿½ï¿½ ï¿½ï¿½ ï¿½Ö´ï¿½.

    private int maxHp = 100;
    private int seaDamage = 5;
    private int restorevalue = 10; 

    public SpriteRenderer flshSpriteRenderer;
    public PlayerMove playerMove;
   

    private void Awake()
    {
<<<<<<< HEAD:Assets/Resource/Player/PlayerHealth.cs
        //ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æ® ï¿½Ò´ï¿½: ï¿½Ç°ï¿½ ï¿½Ã¿ï¿½ ï¿½ï¿½ ï¿½ï¿½È¯
=======
        //ÄÄÆ÷³ÍÆ® ÇÒ´ç: ÇÇ°Ý ½Ã¿¡ »ö º¯È¯À» À§ÇÔ
>>>>>>> develop:Assets/Scripts/PlayerHealth.cs
        flshSpriteRenderer = GetComponent<SpriteRenderer>();
        //ÄÄÆ÷³ÍÆ® ÇÒ´ç: ¹Ù´Ù¿Í À°Áö ÆÇº° À§ÇÔ
        playerMove = GetComponent<PlayerMove>();
    }

    protected override void OnEnable()
    {
        startingHealth = 100;
        // LivingEntityï¿½ï¿½ OnEnable() ï¿½ï¿½ï¿½ï¿½ (ï¿½ï¿½ï¿½ï¿½ ï¿½Ê±ï¿½È­)
        base.OnEnable();

    }

<<<<<<< HEAD:Assets/Resource/Player/PlayerHealth.cs
    // ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ Ã³ï¿½ï¿½
=======
    private void Update()
    {
        //¹Ù´Ù, À°Áö È®ÀÎÇÏ¿© ÇÇ¸¦ ±ð´Â´Ù
        if (playerMove.onboard != true)
        {
            OnDamage(seaDamage,null, new Vector3(0, 0, 0), new Vector3(0, 0, 0));
        }
        else
        {

            if (dead == false)
            {
                if (health >= maxHp)
                {
                    health = maxHp;
                }
                else
                {
                    Restoring(restorevalue);            
                }
            }
            
        }


    }
    //ÃµÃµÈ÷ È¸º¹ÇÏ´Â ÄÚ·çÆ¾ Ã³¸®
    private IEnumerator Restoring(int value)
    {
        RestoreHealth(value);
        yield return new WaitForSeconds(4f);
    }


    //È¸º¹ Ã³¸®
    public override void RestoreHealth(float newHealth)
    {
        // LivingEntityÀÇ RestoreHealth() ½ÇÇà (Ã¼·Â Áõ°¡)
        base.RestoreHealth(newHealth);
    }

    // µ¥¹ÌÁö Ã³¸®
>>>>>>> develop:Assets/Scripts/PlayerHealth.cs
    public override void OnDamage(float damage, GameObject hiter, Vector3 hitPoint, Vector3 hitDirection)
    {
        if (!dead)
        {
            //ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 1ï¿½Ê°ï¿½ ï¿½ï¿½È¯ï¿½Ï´ï¿½ ï¿½Ú·ï¿½Æ¾ ï¿½ï¿½ï¿½ï¿½
            StartCoroutine(DamageEffect());
        }

        // LivingEntityï¿½ï¿½ OnDamage() ï¿½ï¿½ï¿½ï¿½(ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ ï¿½ï¿½ï¿½ï¿½)
        base.OnDamage(damage, hiter ,hitPoint, hitDirection);
    }
    //ï¿½ï¿½ ï¿½ï¿½È¯ ï¿½Ú·ï¿½Æ¾ ï¿½ï¿½ï¿½ï¿½
    private IEnumerator DamageEffect()
    {
        flshSpriteRenderer.material.color = new Color(1f, 168 / 255f, 168 / 255f);
        yield return new WaitForSeconds(2f);
        flshSpriteRenderer.material.color = new Color(1f, 1f, 1f);
    }
    


    public override void Die()
    {
        // LivingEntityï¿½ï¿½ Die() ï¿½ï¿½ï¿½ï¿½
        base.Die();
    }
}

