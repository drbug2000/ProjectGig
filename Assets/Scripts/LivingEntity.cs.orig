using System;
using UnityEngine;

// ìƒëª…ì²´ ê²Œì„ ì˜¤ë¸Œì íŠ¸ì˜ ë¼ˆëŒ€
// Health , OnDamage, Die, restoreHealth, onDeath ì´ë²¤íŠ¸ë¥¼ ì œê³µ


public class LivingEntity : MonoBehaviour, IDamageable
{
<<<<<<< HEAD
    public float startingHealth; // ½ÃÀÛ Ã¼·Â
    public float maxHp;
    public float health { get; protected set; } // ÇöÀç Ã¼·Â
    public bool dead { get; protected set; } // »ç¸Á »óÅÂ
    public event Action onDeath; // »ç¸Á½Ã ¹ßµ¿ÇÒ ÀÌº¥Æ®
=======
    public float startingHealth; // ì‹œì‘ ì²´ë ¥
    public float health { get; protected set; } // í˜„ì¬ ì²´ë ¥
    public bool dead { get; protected set; } // ì‚¬ë§ ìƒíƒœ
    public event Action onDeath; // ì‚¬ë§ì‹œ ë°œë™í•  ì´ë²¤íŠ¸
>>>>>>> develop

    // ìƒëª…ì²´ê°€ í™œì„±í™”ë ë•Œ ìƒíƒœë¥¼ ë¦¬ì…‹
    protected virtual void OnEnable()
    {
        // ì‚¬ë§í•˜ì§€ ì•Šì€ ìƒíƒœë¡œ ì‹œì‘
        dead = false;
        // ì²´ë ¥ì„ ì‹œì‘ ì²´ë ¥ìœ¼ë¡œ ì´ˆê¸°í™”
        
        health = startingHealth;
    }

    // ë°ë¯¸ì§€ë¥¼ ì…ëŠ” ê¸°ëŠ¥
    public virtual void OnDamage(float damage, GameObject hiter, Vector3 hitPoint, Vector3 hitNormal)
    {
        // ë°ë¯¸ì§€ë§Œí¼ ì²´ë ¥ ê°ì†Œ
        health -= damage;
        Debug.Log("fishHP script : heart"+ health);
        // ì²´ë ¥ì´ 0 ì´í•˜ && ì•„ì§ ì£½ì§€ ì•Šì•˜ë‹¤ë©´ ì‚¬ë§ ì²˜ë¦¬ ì‹¤í–‰
        if (health <= 0 && !dead)
        {
            Die();
        }
    }

    public virtual void RestoreHealth(float newHealth)
    {
        if (dead)
        {
            // ì´ë¯¸ ì‚¬ë§í•œ ê²½ìš° ì²´ë ¥ì„ íšŒë³µí•  ìˆ˜ ì—†ìŒ
            return;
        }
<<<<<<< HEAD
         health += newHealth;
            
=======

        // ì²´ë ¥ ì¶”ê°€
        health += newHealth;
>>>>>>> develop
    }


    // ì‚¬ë§ ì²˜ë¦¬
    public virtual void Die()
    {
        // onDeath ì´ë²¤íŠ¸ì— ë“±ë¡ëœ ë©”ì„œë“œê°€ ìˆë‹¤ë©´ ì‹¤í–‰
        if (onDeath != null)
        {
            onDeath();
        }

        // ì‚¬ë§ ìƒíƒœë¥¼ ì°¸ìœ¼ë¡œ ë³€ê²½
        dead = true;
    }
}